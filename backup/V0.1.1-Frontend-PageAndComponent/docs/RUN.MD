# ğŸš€ HÆ°á»›ng Dáº«n Khá»Ÿi Äá»™ng Há»‡ Thá»‘ng

## ğŸ—ï¸ Cáº¥u trÃºc há»‡ thá»‘ng
```
â”œâ”€â”€ load-balancer/          # Load Balancer service ğŸ”„
â”‚   â”œâ”€â”€ index.js           # Logic load balancing vá»›i health check & Ä‘Äƒng kÃ½ mÃ¡y chá»§ ğŸ§ª
â”‚   â””â”€â”€ package.json       # Dependencies ğŸ“¦
â”œâ”€â”€ web-servers/            # Web Servers cluster ğŸŒ
â”‚   â”œâ”€â”€ server1.js         # Web server chÃ­nh (cá»•ng 21000) ğŸ’»
â”‚   â””â”€â”€ package.json       # Dependencies ğŸ“¦
â”œâ”€â”€ db-services/            # DB Services layer ğŸ’¾
â”‚   â”œâ”€â”€ index.js           # Logic DB vá»›i tá»± Ä‘á»™ng Ä‘Äƒng kÃ½ vá»›i DB Gateway ğŸ’¾
â”‚   â””â”€â”€ package.json       # Dependencies ğŸ“¦
â”œâ”€â”€ db-gateway/             # DB Gateway trung gian giá»¯a Web & DB ğŸ”„
â”‚   â”œâ”€â”€ index.js           # Logic Ä‘iá»u phá»‘i DB theo tÃªn & health check ğŸ§ª
â”‚   â””â”€â”€ package.json       # Dependencies ğŸ“¦
â”œâ”€â”€ start-system.sh         # Script khá»Ÿi Ä‘á»™ng toÃ n há»‡ thá»‘ng ğŸš€
â”œâ”€â”€ stop-system.sh          # Script táº¯t toÃ n há»‡ thá»‘ng ğŸ›‘
â”œâ”€â”€ frontend/               # Frontend React cho há»‡ thá»‘ng ğŸ¨
â”‚   â”œâ”€â”€ src/              # Source code frontend
â”‚   â”œâ”€â”€ package.json      # Dependencies frontend
â”‚   â””â”€â”€ vite.config.js    # Cáº¥u hÃ¬nh Vite
â”œâ”€â”€ backup/                 # ThÆ° má»¥c sao lÆ°u há»‡ thá»‘ng ğŸ’¾
â””â”€â”€ docs/                   # TÃ i liá»‡u há»‡ thá»‘ng ğŸ“š
    â”œâ”€â”€ README.MD          # Tá»•ng quan há»‡ thá»‘ng ğŸ“‹
    â”œâ”€â”€ UI.MD              # Giao diá»‡n ngÆ°á»i dÃ¹ng ğŸ¨
    â”œâ”€â”€ CHANGELOG.MD       # Nháº­t kÃ½ thay Ä‘á»•i ğŸ“
    â””â”€â”€ RUN.MD             # HÆ°á»›ng dáº«n khá»Ÿi Ä‘á»™ng (báº¡n Ä‘ang Ä‘á»c file nÃ y) ğŸ“–
```

## ğŸ› ï¸ YÃªu cáº§u há»‡ thá»‘ng
- Node.js v18+ ğŸ’»
- NPM ğŸ“¦

## ğŸš€ CÃ¡ch khá»Ÿi Ä‘á»™ng há»‡ thá»‘ng

### 1. CÃ i Ä‘áº·t dependencies ğŸ“¦
```bash
cd load-balancer && npm install
cd ../web-servers && npm install
cd ../db-services && npm install
cd ../db-gateway && npm install
cd ../frontend && npm install
```

### 2. Khá»Ÿi Ä‘á»™ng báº±ng script (khuyáº¿n nghá»‹) ğŸ¤–
```bash
./start-system.sh
```
Script sáº½ tá»± Ä‘á»™ng:
- Khá»Ÿi Ä‘á»™ng DB Gateway (cá»•ng 29500) ğŸ”Œ
- Khá»Ÿi Ä‘á»™ng DB Services (cá»•ng 29001-29003) ğŸ’¾
- Khá»Ÿi Ä‘á»™ng Load Balancer (cá»•ng 20000) ğŸ”„
- Khá»Ÿi Ä‘á»™ng Web Servers (cá»•ng 21000-21002) ğŸŒ
- Khá»Ÿi Ä‘á»™ng Frontend (cá»•ng 19000 máº·c Ä‘á»‹nh) ğŸ¨
- Tá»± Ä‘á»™ng cÃ i Ä‘áº·t dependencies cho táº¥t cáº£ dá»‹ch vá»¥ ğŸ“¦

### 3. Cháº¡y frontend trÃªn cá»•ng tÃ¹y chá»n ğŸŒ
```bash
FRONTEND_PORT=4000 ./start-system.sh
```
Frontend sáº½ cháº¡y trÃªn cá»•ng 4000 thay vÃ¬ 19000.

### 3. Thá»§ cÃ´ng tá»«ng dá»‹ch vá»¥ (náº¿u cáº§n) âš™ï¸

#### B1: Khá»Ÿi Ä‘á»™ng DB Gateway (pháº£i cháº¡y TRÆ¯á»šC táº¥t cáº£) ğŸ”Œ
```bash
cd db-gateway
node index.js
```

#### B2: Khá»Ÿi Ä‘á»™ng DB Services (sáº½ tá»± Ä‘á»™ng Ä‘Äƒng kÃ½ vá»›i DB Gateway) ğŸ’¾
```bash
cd db-services
# users_db (cá»•ng 29001)
DB_ID=1 DB_NAME=users_db PORT=29001 node index.js

# products_db (cá»•ng 29002)
DB_ID=2 DB_NAME=products_db PORT=29002 node index.js

# orders_db (cá»•ng 29003)
DB_ID=3 DB_NAME=orders_db PORT=29003 node index.js
```

#### B3: Khá»Ÿi Ä‘á»™ng Load Balancer ğŸ”„
```bash
cd load-balancer
node index.js
```

#### B4: Khá»Ÿi Ä‘á»™ng Web Servers (sáº½ tá»± Ä‘á»™ng Ä‘Äƒng kÃ½ vá»›i Load Balancer) ğŸŒ
```bash
cd web-servers
# Web Server 1 (cá»•ng 21000)
SERVER_ID=server1 PORT=21000 node server1.js

# Web Server 2 (cá»•ng 21001)
SERVER_ID=server2 PORT=21001 node server1.js

# Web Server 3 (cá»•ng 21002)
SERVER_ID=server3 PORT=21002 node server1.js
```

## ğŸ§ª Kiá»ƒm tra há»‡ thá»‘ng
- **Frontend**: http://localhost:19000 ğŸ¨ (hoáº·c cá»•ng tÃ¹y chá»n)
- **Load Balancer**: http://localhost:20000 ğŸŒ
- **Load Balancer Health**: http://localhost:20000/health ğŸ§ª
- **DB Gateway**: http://localhost:29500 ğŸ”Œ
- **DB Gateway Health**: http://localhost:29500/health ğŸ§ª
- **Web Server**: http://localhost:21000, 21001, 21002 ğŸ’»
- **Web Server Health**: http://localhost:21000/health, 21001/health, 21002/health ğŸ§ª

## ğŸ“ˆ Gá»­i yÃªu cáº§u thá»­
```bash
# Gá»­i yÃªu cáº§u Ä‘áº¿n Load Balancer (sáº½ chuyá»ƒn tiáº¿p Ä‘áº¿n Web Server khá»e)
curl -X POST http://localhost:20000/api/data -d '{"test": "data"}' -H "Content-Type: application/json"

# Gá»­i yÃªu cáº§u trá»±c tiáº¿p Ä‘áº¿n Web Server
curl -X POST http://localhost:21000/api/data -d '{"test": "data"}' -H "Content-Type: application/json"

# Gá»­i yÃªu cáº§u Ä‘áº¿n DB qua DB Gateway
curl -X GET http://localhost:29500/db/users_db/health
```

## ğŸ”„ Kiáº¿n trÃºc 5 lá»›p (cÃ³ Frontend)
```
NgÆ°á»i DÃ¹ng ğŸ‘¤ â†’ Frontend:19000+ ğŸ¨ â†’ Load Balancer:20000 ğŸ”„ â†’ Web Servers:21000+ ğŸŒ â†’ DB Gateway:29500 ğŸ”€ â†’ DB Services:29000+ ğŸ’¾
```
- Frontend: Giao diá»‡n ngÆ°á»i dÃ¹ng & giÃ¡m sÃ¡t há»‡ thá»‘ng ğŸ¨
- Load Balancer: Äiá»u phá»‘i ngÆ°á»i dÃ¹ng Ä‘áº¿n Web Servers khá»e ğŸ”„
- Web Servers: Xá»­ lÃ½ yÃªu cáº§u ngÆ°á»i dÃ¹ng & káº¿t ná»‘i DB qua DB Gateway ğŸŒ
- DB Gateway: Äiá»u phá»‘i yÃªu cáº§u DB Ä‘áº¿n cÃ¡c CSDL phÃ¹ há»£p ğŸ”€
- DB Services: Xá»­ lÃ½ dá»¯ liá»‡u ngÆ°á»i dÃ¹ng ğŸ’¾

## ğŸ›‘ Dá»«ng há»‡ thá»‘ng
### DÃ¹ng script (khuyáº¿n nghá»‹) ğŸ¤–
```bash
./stop-system.sh
```
Script sáº½:
- Dá»«ng táº¥t cáº£ tiáº¿n trÃ¬nh Node.js liÃªn quan Ä‘áº¿n há»‡ thá»‘ng â¹ï¸
- Tá»± Ä‘á»™ng gá»¡ Ä‘Äƒng kÃ½ Web Server khá»i Load Balancer âœ…
- Tá»± Ä‘á»™ng gá»¡ Ä‘Äƒng kÃ½ DB khá»i DB Gateway âœ…
- Dá»n dáº¹p sáº¡ch sáº½, an toÃ n ğŸ’¯

### Thá»§ cÃ´ng âš™ï¸
- DÃ¹ng `Ctrl+C` trÃªn tá»«ng terminal Ä‘ang cháº¡y dá»‹ch vá»¥ â¹ï¸
  - Web Server sáº½ **tá»± Ä‘á»™ng gá»¡ Ä‘Äƒng kÃ½** khá»i Load Balancer âœ…
  - DB Service sáº½ **tá»± Ä‘á»™ng gá»¡ Ä‘Äƒng kÃ½** khá»i DB Gateway âœ…

## ğŸ’¾ Backup & Restore
### Sao lÆ°u phiÃªn báº£n hiá»‡n táº¡i
- ThÆ° má»¥c `backup/V0.0.1-KhoiDauCuaDuAn/` chá»©a báº£n sao lÆ°u Ä‘áº§u tiÃªn ğŸ’¾
- Chá»©a toÃ n bá»™: Load Balancer, Web Servers, DB Services, DB Gateway, Docs

### KhÃ´i phá»¥c tá»« báº£n sao lÆ°u
- Copy ná»™i dung tá»« `backup/V0.0.1-KhoiDauCuaDuAn/` ra thÆ° má»¥c gá»‘c ğŸ’¾
- Cháº¡y `./start-system.sh` Ä‘á»ƒ khá»Ÿi Ä‘á»™ng láº¡i há»‡ thá»‘ng

## ğŸ“ Ghi chÃº
- **Frontend**: Giao diá»‡n React vá»›i proxy Ä‘áº¿n backend ğŸ¨
- **DB Gateway** lÃ  dá»‹ch vá»¥ trung gian giá»¯a Web & DB ğŸ”€
- **Web Servers** káº¿t ná»‘i DB thÃ´ng qua DB Gateway ğŸŒ
- **Load Balancer** chá»‰ Ä‘iá»u phá»‘i ngÆ°á»i dÃ¹ng, khÃ´ng can thiá»‡p dá»¯ liá»‡u ğŸ”„
- **CÆ¡ cháº¿ Ä‘Äƒng kÃ½**: Web/DB tá»± Ä‘á»™ng Ä‘Äƒng kÃ½ khi khá»Ÿi Ä‘á»™ng, gá»¡ khi táº¯t âœ…
- **Health check**: Má»—i 10 giÃ¢y cáº­p nháº­t tráº¡ng thÃ¡i mÃ¡y chá»§ ğŸ”„
- **Frontend**: cá»•ng 19000+ (máº·c Ä‘á»‹nh 19000) ğŸ¨
- **Load Balancer**: cá»•ng 20000 ğŸ”„
- **Web Servers**: cá»•ng 21000-28000 ğŸŒ
- **DB Gateway**: cá»•ng 29500 ğŸ”€
- **DB Services**: cá»•ng 29000+ ğŸ’¾